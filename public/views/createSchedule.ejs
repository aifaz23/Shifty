<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Schedule</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Custom CSS link -->
    <link rel="stylesheet" type="text/css" href="../css/createSchedule.css">

</head>

<body>
  <nav class="navbar navbar-expand-md navbar-dark bg-dark">
    <div class="container-fluid">
        <button class="navbar-toggler flex-grow-sm-1 flex-grow-0 me-2" type="button" data-bs-toggle="collapse" data-bs-target=".dual-collapse2">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
            <ul class="navbar-nav me-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#"><i class="fa fa-house icon"></i> Home</a>
                </li>
                <li class="nav-item dropdown current">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarScrollingDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa fa-calendar icon"></i> Schedule </a>
                    <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-right" id="drop1" aria-labelledby="navbarScrollingDropdown">
                        <li><a class="dropdown-item" href="http://localhost:8080/createSchedule" id="cur"><i class="fa-solid fa-calendar-plus icon"></i> Create Schedule</a></li>
                        <li><a class="dropdown-item" href="http://localhost:8080/editSchedule" id="curNei1"><i class="fa-solid fa-pen-to-square icon"></i> Edit Schedule</a></li>
                        <li><a class="dropdown-item" href="http://localhost:8080/viewSchedule" id="curNei2"><i class="fa fa-eye icon"></i> View Schedule</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#"><i class="fa fa-user-group icon"></i> Team</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#"><i class="fas fa-arrow-right-arrow-left icon"></i> Shift Change</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarScrollingDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-solid fa-briefcase icon"></i> Management </a>
                    <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-right" aria-labelledby="navbarScrollingDropdown">
                        <li><a class="dropdown-item" href="http://localhost:8080/addEmployee"><i class="fa-solid fa-user-plus icon"></i> Add Employee</a></li>
                        <li><a class="dropdown-item" href="http://localhost:8080/removeEmployee"><i class="fa-solid fa-user-minus icon"></i> Remove Employee</a></li>
                        <li><a class="dropdown-item" href="http://localhost:8080/addManager"><i class="fa-solid fa-user-plus icon"></i> Add Manager</a></li>
                        <li><a class="dropdown-item" href="http://localhost:8080/removeManager"><i class="fa-solid fa-user-minus icon"></i> Remove Manager</a></li>
                    </ul>
                </li>
            </ul>
        </div>

        <div class="navbar-collapse collapse w-25 order-3 dual-collapse2">
            <ul class="navbar-nav ms-auto buttons">
                <li class="nav-item">
                    <a class="nav-link" href="#">
                        <button class="btn btn-sm btn-primary prof-btn" type="submit">My Profile</button>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="http://localhost:8080/">
                        <button class="btn btn-sm btn-primary log-btn" type="submit">Log Out</button>
                    </a>
                </li>
            </ul>
        </div>
    </div>
  </nav>

  <div>
    <label for="input">Name to add to schedule</label>
    <input type="text" id="name">


    <button onclick="add()">Add to Schedule</button>

    <button onclick="finish()">Finalize Schedule</button>
  </div>

  <br>
  <table class="table">
    <thead>
      <tr>
        <th scope="col">Sunday</th>
        <th scope="col">Monday</th>
        <th scope="col">Tuesday</th>
        <th scope="col">Wednesday</th>
        <th scope="col">Thursday</th>
        <th scope="col">Friday</th>
        <th scope="col">Saturday</th>
      </tr>
    </thead>
    <tbody>
      <tr>
      <tr>
        <td><input type="text" id="sunday"></td>
        <td><input type="text" id="monday"></td>
        <td><input type="text" id="tuesday"></td>
        <td><input type="text" id="wednesday"></td>
        <td><input type="text" id="thursday"></td>
        <td><input type="text" id="friday"></td>
        <td><input type="text" id="saturday"></td>
      </tr>
      </tr>
    </tbody>
  </table>

  <br>
  <p>Preview of Schedule</p>
  <div>

    <table id="Schedule" class="table">
      <thead>
        <tr>
          <th scope="col">Employees</th>
          <th scope="col">Sunday</th>
          <th scope="col">Monday</th>
          <th scope="col">Tuesday</th>
          <th scope="col">Wednesday</th>
          <th scope="col">Thursday</th>
          <th scope="col">Friday</th>
          <th scope="col">Saturday</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
    
    <!-- Link for using Axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>

  function add() {
    const schedulediv = document.getElementById("Schedule")

    let elementExists = !!document.getElementById(document.getElementById('name').value)
    if (elementExists == false) {
      var new_row = document.createElement('tr')
      new_row.id = document.getElementById('name').value;
      schedulediv.append(new_row)

    }
    else if (elementExists == true) {
      alert('This employee is already in the schedule')
      return
    }
    console.log(elementExists)


    var name = document.createElement('td')
    name.innerText = document.getElementById('name').value

    var sunday = document.createElement('td')
    sunday.innerText = document.getElementById('sunday').value

    var monday = document.createElement('td')
    monday.innerText = document.getElementById('monday').value

    var tuesday = document.createElement('td')
    tuesday.innerText = document.getElementById('tuesday').value


    var wednesday = document.createElement('td')
    wednesday.innerText = document.getElementById('wednesday').value

    var thursday = document.createElement('td')
    thursday.innerText = document.getElementById('thursday').value

    var friday = document.createElement('td')
    friday.innerText = document.getElementById('friday').value

    var saturday = document.createElement('td')
    saturday.innerText = document.getElementById('saturday').value


    var add = document.getElementById(document.getElementById('name').value)
    add.append(name, sunday, monday, tuesday, wednesday, thursday, friday, saturday)

    document.getElementById('sunday').value = ''
    document.getElementById('monday').value = ''
    document.getElementById('tuesday').value = ''
    document.getElementById('wednesday').value = ''
    document.getElementById('thursday').value = ''
    document.getElementById('friday').value = ''
    document.getElementById('saturday').value = ''
  }

  function finish() {
    let schedule = document.getElementById('Schedule').rows.length

    let shifts = []
    for (let i = 1; i < schedule; i++) {

      let new_shift = {
        name: document.getElementById('Schedule').rows[i].cells.item(0).innerText,
        sunday: document.getElementById('Schedule').rows[i].cells.item(1).innerText,
        monday: document.getElementById('Schedule').rows[i].cells.item(2).innerText,
        tuesday: document.getElementById('Schedule').rows[i].cells.item(3).innerText,
        wednesday: document.getElementById('Schedule').rows[i].cells.item(4).innerText,
        thursday: document.getElementById('Schedule').rows[i].cells.item(5).innerText,
        friday: document.getElementById('Schedule').rows[i].cells.item(6).innerText,
        saturday: document.getElementById('Schedule').rows[i].cells.item(7).innerText
      }

      shifts.push(new_shift)
    }

    console.log(shifts);
    axios.post('/createSchedule', shifts).then((res) => {
      alert("Successfully Submitted Schedule")
    }).catch((err) => {
      console.log(err)
    })


  }
</script>
</body>
</html>
